<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å•æµ‹è¯•é¡µé¢</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .test-box { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { border-left: 4px solid #28a745; }
        .error { border-left: 4px solid #dc3545; }
        .info { border-left: 4px solid #17a2b8; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; background: #007bff; color: white; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Avatar Background Swap - ç®€å•æµ‹è¯•</h1>
    
    <div class="test-box info">
        <h3>ğŸ“ å½“å‰ä½ç½®</h3>
        <p>URL: <code id="current-url"></code></p>
        <p>æ—¶é—´: <code id="current-time"></code></p>
    </div>

    <div class="test-box" id="file-test">
        <h3>ğŸ“ æ–‡ä»¶æµ‹è¯•</h3>
        <button onclick="testFiles()">æµ‹è¯•æ–‡ä»¶è®¿é—®</button>
        <div id="file-results"></div>
    </div>

    <div class="test-box" id="network-test">
        <h3>ğŸŒ ç½‘ç»œæµ‹è¯•</h3>
        <button onclick="testNetwork()">æµ‹è¯•ç½‘ç»œè¿æ¥</button>
        <div id="network-results"></div>
    </div>

    <div class="test-box" id="app-test">
        <h3>ğŸš€ åº”ç”¨æµ‹è¯•</h3>
        <button onclick="testApp()">æµ‹è¯•ä¸»åº”ç”¨</button>
        <div id="app-results"></div>
    </div>

    <script>
        // æ›´æ–°é¡µé¢ä¿¡æ¯
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('current-time').textContent = new Date().toLocaleString();

        async function testFiles() {
            const results = document.getElementById('file-results');
            results.innerHTML = '<p>æ­£åœ¨æµ‹è¯•æ–‡ä»¶è®¿é—®...</p>';

            const tests = [
                { name: 'index.html', url: './index.html' },
                { name: 'favicon.svg', url: './favicon.svg' },
                { name: '404.html', url: './404.html' }
            ];

            let html = '';
            for (const test of tests) {
                try {
                    const response = await fetch(test.url);
                    if (response.ok) {
                        html += `<p>âœ… ${test.name}: OK (${response.status})</p>`;
                    } else {
                        html += `<p>âŒ ${test.name}: ${response.status} ${response.statusText}</p>`;
                    }
                } catch (error) {
                    html += `<p>âŒ ${test.name}: ${error.message}</p>`;
                }
            }

            // æµ‹è¯•assetsç›®å½•
            try {
                const indexResponse = await fetch('./index.html');
                const indexHtml = await indexResponse.text();
                
                const jsMatch = indexHtml.match(/src="\.\/assets\/(index-[^"]+\.js)"/);
                const cssMatch = indexHtml.match(/href="\.\/assets\/(index-[^"]+\.css)"/);
                
                if (jsMatch) {
                    const jsUrl = `./assets/${jsMatch[1]}`;
                    try {
                        const response = await fetch(jsUrl);
                        if (response.ok) {
                            html += `<p>âœ… ä¸»JSæ–‡ä»¶: ${jsMatch[1]} (${response.status})</p>`;
                        } else {
                            html += `<p>âŒ ä¸»JSæ–‡ä»¶: ${response.status} ${response.statusText}</p>`;
                        }
                    } catch (error) {
                        html += `<p>âŒ ä¸»JSæ–‡ä»¶: ${error.message}</p>`;
                    }
                }

                if (cssMatch) {
                    const cssUrl = `./assets/${cssMatch[1]}`;
                    try {
                        const response = await fetch(cssUrl);
                        if (response.ok) {
                            html += `<p>âœ… ä¸»CSSæ–‡ä»¶: ${cssMatch[1]} (${response.status})</p>`;
                        } else {
                            html += `<p>âŒ ä¸»CSSæ–‡ä»¶: ${response.status} ${response.statusText}</p>`;
                        }
                    } catch (error) {
                        html += `<p>âŒ ä¸»CSSæ–‡ä»¶: ${error.message}</p>`;
                    }
                }
            } catch (error) {
                html += `<p>âŒ æ— æ³•è§£æindex.html: ${error.message}</p>`;
            }

            results.innerHTML = html;
        }

        async function testNetwork() {
            const results = document.getElementById('network-results');
            results.innerHTML = '<p>æ­£åœ¨æµ‹è¯•ç½‘ç»œè¿æ¥...</p>';

            const tests = [
                { name: 'MediaPipe CDN', url: 'https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js' },
                { name: 'Google Fonts', url: 'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap' },
                { name: 'jsDelivr CDN', url: 'https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js' }
            ];

            let html = '';
            for (const test of tests) {
                try {
                    const response = await fetch(test.url, { mode: 'no-cors' });
                    html += `<p>âœ… ${test.name}: å¯è®¿é—®</p>`;
                } catch (error) {
                    html += `<p>âŒ ${test.name}: ${error.message}</p>`;
                }
            }

            results.innerHTML = html;
        }

        async function testApp() {
            const results = document.getElementById('app-results');
            results.innerHTML = '<p>æ­£åœ¨æµ‹è¯•ä¸»åº”ç”¨...</p>';

            try {
                // åˆ›å»ºä¸€ä¸ªiframeæ¥åŠ è½½ä¸»åº”ç”¨
                const iframe = document.createElement('iframe');
                iframe.src = './index.html';
                iframe.style.width = '100%';
                iframe.style.height = '300px';
                iframe.style.border = '1px solid #ddd';
                iframe.style.borderRadius = '4px';
                
                iframe.onload = () => {
                    results.innerHTML = '<p>âœ… ä¸»åº”ç”¨iframeåŠ è½½æˆåŠŸ</p>' + iframe.outerHTML;
                };
                
                iframe.onerror = (error) => {
                    results.innerHTML = `<p>âŒ ä¸»åº”ç”¨iframeåŠ è½½å¤±è´¥: ${error}</p>`;
                };

                results.innerHTML = '<p>æ­£åœ¨åŠ è½½ä¸»åº”ç”¨iframe...</p>';
                
            } catch (error) {
                results.innerHTML = `<p>âŒ åº”ç”¨æµ‹è¯•å¤±è´¥: ${error.message}</p>`;
            }
        }

        // è‡ªåŠ¨è¿è¡ŒåŸºæœ¬æµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(testFiles, 1000);
        });
    </script>
</body>
</html>
